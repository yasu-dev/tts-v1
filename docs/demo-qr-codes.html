<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>トリアージシステム デモ用QRコード</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .patient-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .patient-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            page-break-inside: avoid;
        }
        .patient-card h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .qr-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 4px;
        }
        .patient-info {
            font-size: 14px;
            line-height: 1.8;
        }
        .patient-info strong {
            color: #2c3e50;
            display: inline-block;
            min-width: 120px;
        }
        .tag-label {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            margin-left: 10px;
        }
        .tag-red { background-color: #e74c3c; color: white; }
        .tag-yellow { background-color: #f39c12; color: white; }
        .tag-green { background-color: #27ae60; color: white; }
        .tag-black { background-color: #34495e; color: white; }
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 30px;
        }
        .instructions h3 {
            margin-top: 0;
            color: #856404;
        }
        @media print {
            body {
                background: white;
            }
            .patient-card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            .instructions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <h1>🏥 トリアージシステム デモ用QRコード</h1>

    <div class="instructions">
        <h3>使い方</h3>
        <p>
            1. このページを印刷するか、タブレット/スマホで表示します<br>
            2. トリアージ画面（/triage/scan）で「QRコード読み込み」を選択<br>
            3. カメラでQRコードをスキャン<br>
            4. 患者情報が自動入力されます
        </p>
    </div>

    <div class="patient-grid" id="patientGrid"></div>

    <script>
        const demoPatients = [
            {
                id: "DEMO-001",
                name: "患者1（フェーズ2のシナリオ用）",
                age: 35,
                gender: "女性",
                location: "新宿区西新宿2-10-5",
                chiefComplaint: "右足骨折、打撲",
                vitals: {
                    respiratoryRate: 18,
                    heartRate: 85,
                    spO2: 97,
                    bloodPressure: "120/75",
                    consciousnessLevel: "JCS 0"
                },
                startAssessment: {
                    canWalk: false,
                    isBreathing: true,
                    hasRadialPulse: true,
                    followsCommands: true
                },
                expectedTag: "黄",
                notes: "歩行不可だが、バイタル安定、意識清明"
            },
            {
                id: "DEMO-002",
                name: "患者2（赤タグ - 重症）",
                age: 52,
                gender: "男性",
                location: "新宿区西新宿2-8-1",
                chiefComplaint: "胸部圧迫、呼吸困難",
                vitals: {
                    respiratoryRate: 28,
                    heartRate: 120,
                    spO2: 88,
                    bloodPressure: "90/60",
                    consciousnessLevel: "JCS 1"
                },
                startAssessment: {
                    canWalk: false,
                    isBreathing: true,
                    hasRadialPulse: false,
                    followsCommands: true
                },
                expectedTag: "赤",
                notes: "橈骨動脈触知不可、呼吸促迫"
            },
            {
                id: "DEMO-003",
                name: "患者3（緑タグ - 軽症）",
                age: 28,
                gender: "女性",
                location: "新宿区西新宿2-11-2",
                chiefComplaint: "左前腕擦過傷",
                vitals: {
                    respiratoryRate: 16,
                    heartRate: 78,
                    spO2: 99,
                    bloodPressure: "115/70",
                    consciousnessLevel: "JCS 0"
                },
                startAssessment: {
                    canWalk: true,
                    isBreathing: true,
                    hasRadialPulse: true,
                    followsCommands: true
                },
                expectedTag: "緑",
                notes: "歩行可能、軽度の外傷のみ"
            },
            {
                id: "DEMO-004",
                name: "患者4（黄タグ - 中等症）",
                age: 67,
                gender: "男性",
                location: "新宿区西新宿2-9-3",
                chiefComplaint: "左大腿骨骨折疑い",
                vitals: {
                    respiratoryRate: 20,
                    heartRate: 92,
                    spO2: 95,
                    bloodPressure: "130/85",
                    consciousnessLevel: "JCS 0"
                },
                startAssessment: {
                    canWalk: false,
                    isBreathing: true,
                    hasRadialPulse: true,
                    followsCommands: true
                },
                expectedTag: "黄",
                notes: "下肢骨折、歩行不可だがバイタル安定"
            },
            {
                id: "DEMO-005",
                name: "患者5（赤タグ - 重症）",
                age: 41,
                gender: "女性",
                location: "新宿区西新宿2-7-4",
                chiefComplaint: "頭部外傷、意識レベル低下",
                vitals: {
                    respiratoryRate: 24,
                    heartRate: 110,
                    spO2: 91,
                    bloodPressure: "100/65",
                    consciousnessLevel: "JCS 10"
                },
                startAssessment: {
                    canWalk: false,
                    isBreathing: true,
                    hasRadialPulse: true,
                    followsCommands: false
                },
                expectedTag: "赤",
                notes: "意識レベル低下、指示に従えず"
            },
            {
                id: "DEMO-006",
                name: "患者6（緑タグ - 軽症）",
                age: 19,
                gender: "男性",
                location: "新宿区西新宿2-12-1",
                chiefComplaint: "右手関節捻挫",
                vitals: {
                    respiratoryRate: 14,
                    heartRate: 72,
                    spO2: 98,
                    bloodPressure: "110/68",
                    consciousnessLevel: "JCS 0"
                },
                startAssessment: {
                    canWalk: true,
                    isBreathing: true,
                    hasRadialPulse: true,
                    followsCommands: true
                },
                expectedTag: "緑",
                notes: "歩行可能、軽度の捻挫"
            }
        ];

        function getTagClass(tag) {
            const tagMap = {
                '赤': 'tag-red',
                '黄': 'tag-yellow',
                '緑': 'tag-green',
                '黒': 'tag-black'
            };
            return tagMap[tag] || '';
        }

        function createPatientCard(patient) {
            const card = document.createElement('div');
            card.className = 'patient-card';

            const qrData = JSON.stringify({
                id: patient.id,
                age: patient.age,
                gender: patient.gender,
                location: patient.location,
                chiefComplaint: patient.chiefComplaint,
                vitals: patient.vitals,
                startAssessment: patient.startAssessment
            });

            const qrImageUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(qrData)}`;

            card.innerHTML = `
                <h2>
                    ${patient.name}
                    <span class="tag-label ${getTagClass(patient.expectedTag)}">${patient.expectedTag}タグ</span>
                </h2>
                <div class="qr-container">
                    <img src="${qrImageUrl}" alt="QRコード ${patient.id}" />
                </div>
                <div class="patient-info">
                    <div><strong>ID:</strong> ${patient.id}</div>
                    <div><strong>年齢:</strong> ${patient.age}歳</div>
                    <div><strong>性別:</strong> ${patient.gender}</div>
                    <div><strong>発見場所:</strong> ${patient.location}</div>
                    <div><strong>主訴:</strong> ${patient.chiefComplaint}</div>
                    <div style="margin-top: 10px;"><strong>バイタルサイン:</strong></div>
                    <div style="margin-left: 20px;">
                        呼吸: ${patient.vitals.respiratoryRate}回/分<br>
                        心拍: ${patient.vitals.heartRate}回/分<br>
                        SpO2: ${patient.vitals.spO2}%<br>
                        血圧: ${patient.vitals.bloodPressure}<br>
                        意識: ${patient.vitals.consciousnessLevel}
                    </div>
                    <div style="margin-top: 10px;"><strong>備考:</strong> ${patient.notes}</div>
                </div>
            `;

            document.getElementById('patientGrid').appendChild(card);
        }

        demoPatients.forEach(patient => createPatientCard(patient));
    </script>
</body>
</html>
