<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Deployment Guide</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #64748b;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --code-bg: #1e293b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif, 'Noto Sans JP';
            line-height: 1.8;
            color: var(--text-primary);
            background-color: var(--bg-light);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-white);
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--primary-color);
        }

        h2 {
            color: var(--primary-color);
            font-size: 2rem;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        h3 {
            color: var(--text-primary);
            font-size: 1.5rem;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        h4 {
            color: var(--text-primary);
            font-size: 1.25rem;
            margin-top: 25px;
            margin-bottom: 12px;
        }

        h5, h6 {
            color: var(--text-primary);
            margin-top: 20px;
            margin-bottom: 10px;
        }

        p {
            margin-bottom: 15px;
            line-height: 1.8;
        }

        a {
            color: var(--primary-color);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        ul, ol {
            margin-bottom: 15px;
            padding-left: 30px;
        }

        li {
            margin-bottom: 8px;
        }

        code {
            background: var(--bg-light);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            color: #d63384;
        }

        pre {
            background: var(--code-bg);
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 20px;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
            font-size: 0.95em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            border: 1px solid var(--border-color);
            padding: 12px;
            text-align: left;
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
            color: var(--text-primary);
        }

        tr:nth-child(even) {
            background: #f8fafc;
        }

        hr {
            border: none;
            border-top: 2px solid var(--border-color);
            margin: 30px 0;
        }

        strong {
            font-weight: 600;
            color: var(--text-primary);
        }

        em {
            font-style: italic;
        }

        blockquote {
            border-left: 4px solid var(--primary-color);
            padding-left: 20px;
            margin: 20px 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: var(--primary-color);
            color: white;
            border-radius: 6px;
            text-decoration: none;
        }

        .back-link:hover {
            background: #1d4ed8;
            text-decoration: none;
        }

        @media print {
            body {
                background: white;
            }
            .container {
                box-shadow: none;
                padding: 20px;
            }
            .back-link {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 2rem;
            }
            h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">â† å¼•ãç¶™ãè³‡æ–™ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</a>
        <h1>æœ¬ç•ªé‹ç”¨ã«å¿…è¦ãªæ§‹æˆè¦ç´ ã¨å¯¾å‡¦æ–¹æ³•</h1>

<p>
<strong>æœ€çµ‚æ›´æ–°æ—¥</strong>: 2025å¹´10æœˆ3æ—¥
<strong>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</strong>: ğŸ“‹ è¨ˆç”»æ›¸ï¼ˆæœ¬ç•ªç’°å¢ƒæœªæ§‹ç¯‰ï¼‰
</p>

<h2>âš ï¸ é‡è¦ãªæ³¨æ„äº‹é …</h2>

<p>
ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯æœ¬ç•ªç’°å¢ƒã¸ã®ç§»è¡Œè¨ˆç”»æ›¸ã§ã™ã€‚ç¾åœ¨ã¯é–‹ç™ºç’°å¢ƒï¼ˆSQLite + ãƒ¢ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ï¼‰ã§ç¨¼åƒã—ã¦ãŠã‚Šã€æœ¬ç•ªç’°å¢ƒã¸ã®ç§»è¡Œã¯æœªå®Ÿæ–½ã§ã™ã€‚
</p>

<p>
æœ¬ç•ªç’°å¢ƒæ§‹ç¯‰æ™‚ã«ã¯ã€ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ã•ã‚ŒãŸæ‰‹é †ã«å¾“ã£ã¦æ®µéšçš„ã«ç§»è¡Œã‚’è¡Œã£ã¦ãã ã•ã„ã€‚
</p>

<h2>ç›®æ¬¡</h2>
<ul>
<li><a href="#æ¦‚è¦">æ¦‚è¦</a></li></ul>

<ul>
<li><a href="#ç¾çŠ¶ã®é–‹ç™ºç’°å¢ƒã®åˆ¶é™äº‹é …">ç¾çŠ¶ã®é–‹ç™ºç’°å¢ƒã®åˆ¶é™äº‹é …</a></li></ul>

<ul>
<li><a href="#æœ¬ç•ªç’°å¢ƒã¸ã®ç§»è¡Œã«å¿…è¦ãªæ§‹æˆè¦ç´ ">æœ¬ç•ªç’°å¢ƒã¸ã®ç§»è¡Œã«å¿…è¦ãªæ§‹æˆè¦ç´ </a></li></ul>

<ul>
<li><a href="#æ®µéšçš„ç§»è¡Œè¨ˆç”»">æ®µéšçš„ç§»è¡Œè¨ˆç”»</a></li></ul>

<ul>
<li><a href="#è©³ç´°ãªå¯¾å‡¦æ–¹æ³•">è©³ç´°ãªå¯¾å‡¦æ–¹æ³•</a></li></ul>

<ul>
<li><a href="#ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ">ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</a></li></ul>


<h2>æ¦‚è¦</h2>

<p>
æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€FBT-v1ï¼ˆThe World Doorï¼‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ç™ºç’°å¢ƒã‹ã‚‰æœ¬ç•ªç’°å¢ƒã¸ç§»è¡Œã™ã‚‹ãŸã‚ã«å¿…è¦ãªæ§‹æˆè¦ç´ ã¨å…·ä½“çš„ãªå¯¾å‡¦æ–¹æ³•ã‚’è©³ç´°ã«è¨˜è¼‰ã—ãŸã‚‚ã®ã§ã™ã€‚ç¾åœ¨ã®é–‹ç™ºç’°å¢ƒã§ã¯ã€ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã¨ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆSQLiteï¼‰ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€£æºã‚‚ã™ã¹ã¦ãƒ¢ãƒƒã‚¯åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚æœ¬ç•ªé‹ç”¨ã§ã¯ã€ã“ã‚Œã‚‰ã‚’ã™ã¹ã¦å®Ÿéš›ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
</p>

<h2>ç¾çŠ¶ã®é–‹ç™ºç’°å¢ƒã®åˆ¶é™äº‹é …</h2>

<h3>1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å±¤ã®åˆ¶é™</h3>

<h4>ç¾åœ¨ã®æ§‹æˆ</h4>
<ul>
<li><strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</strong>: SQLiteï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ï¼‰</li></ul>

<p>
- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹: <code>prisma/dev.db</code>
- åŒæ™‚æ¥ç¶šæ•°: åˆ¶é™ã‚ã‚Šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ5æ¥ç¶šï¼‰
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³: åŸºæœ¬çš„ãªACIDã‚µãƒãƒ¼ãƒˆã®ã¿
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: å°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã«ã¯ååˆ†ã ãŒã€å¤§è¦æ¨¡é‹ç”¨ã«ã¯ä¸é©
</p>

<h4>åˆ¶é™äº‹é …</h4>
<ul>
<li>è¤‡æ•°ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯</li></ul>

<ul>
<li>ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ãªã—</li></ul>

<ul>
<li>é«˜åº¦ãªã‚¯ã‚¨ãƒªæœ€é©åŒ–æ©Ÿèƒ½ã®æ¬ å¦‚</li></ul>

<ul>
<li>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ãƒªã‚¹ãƒˆã‚¢ã®åˆ¶é™</li></ul>

<ul>
<li>JSONå‹ã‚„Arrayå‹ãªã©ã®é«˜åº¦ãªãƒ‡ãƒ¼ã‚¿å‹ã®ã‚µãƒãƒ¼ãƒˆä¸è¶³</li></ul>


<h3>2. å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æºã®åˆ¶é™</h3>

<h4>eBay API</h4>
<ul>
<li><strong>ç¾çŠ¶</strong>: ãƒ¢ãƒƒã‚¯APIï¼ˆ<code>/api/mock/ebay/*</code>ï¼‰</li></ul>

<ul>
<li><strong>åˆ¶é™äº‹é …</strong>:</li></ul>

<p>
- å›ºå®šãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã¿è¿”å´
- å®Ÿéš›ã®å•†å“å‡ºå“ä¸å¯
- åœ¨åº«åŒæœŸæ©Ÿèƒ½ãªã—
- æ³¨æ–‡æƒ…å ±ã®å–å¾—ä¸å¯
</p>

<h4>é…é€ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆFedExã€ãƒ¤ãƒãƒˆé‹è¼¸ã€ä½å·æ€¥ä¾¿ï¼‰</h4>
<ul>
<li><strong>ç¾çŠ¶</strong>: ã™ã¹ã¦ãƒ¢ãƒƒã‚¯API</li></ul>

<ul>
<li><strong>åˆ¶é™äº‹é …</strong>:</li></ul>

<p>
- å®Ÿéš›ã®ãƒ©ãƒ™ãƒ«ç”Ÿæˆä¸å¯
- ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°æƒ…å ±ã®å–å¾—ä¸å¯
- æ–™é‡‘è¨ˆç®—ã®ç²¾åº¦ä¸è¶³
- é…é€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®æ›´æ–°ãªã—
</p>

<h4>ãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼ˆSendGridï¼‰</h4>
<ul>
<li><strong>ç¾çŠ¶</strong>: ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã®ã¿</li></ul>

<ul>
<li><strong>åˆ¶é™äº‹é …</strong>:</li></ul>

<p>
- å®Ÿéš›ã®ãƒ¡ãƒ¼ãƒ«é€ä¿¡ä¸å¯
- ãƒã‚¦ãƒ³ã‚¹ãƒ»è‹¦æƒ…å‡¦ç†ãªã—
- é–‹å°ç‡ãƒ»ã‚¯ãƒªãƒƒã‚¯ç‡ã®è¿½è·¡ä¸å¯
</p>

<h4>ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</h4>
<ul>
<li><strong>ç¾çŠ¶</strong>: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ<code>uploads/</code>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰</li></ul>

<ul>
<li><strong>åˆ¶é™äº‹é …</strong>:</li></ul>

<p>
- ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®æ¬ å¦‚
- CDNé…ä¿¡ä¸å¯
- å†—é•·æ€§ãªã—
- ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®åˆ¶é™
</p>

<h3>3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–¢é€£ã®åˆ¶é™</h3>

<h4>èªè¨¼ãƒ»èªå¯</h4>
<ul>
<li><strong>ç¾çŠ¶</strong>:</li></ul>

<p>
- å›ºå®šãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ<code>password123</code>ï¼‰
- 2æ®µéšèªè¨¼ç„¡åŠ¹
- JWTç§˜å¯†éµãŒå›ºå®šå€¤ï¼ˆ<code>dev-secret-key</code>ï¼‰
</p>
<ul>
<li><strong>åˆ¶é™äº‹é …</strong>:</li></ul>

<p>
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ãŒé«˜ã„
- æœ¬ç•ªç’°å¢ƒã§ã®ä½¿ç”¨ã¯ä¸å¯
</p>

<h4>ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†</h4>
<ul>
<li><strong>ç¾çŠ¶</strong>: ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆ24æ™‚é–“æœ‰åŠ¹ï¼‰</li></ul>

<ul>
<li><strong>åˆ¶é™äº‹é …</strong>:</li></ul>

<p>
- ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³æ¶ˆå¤±
- è¤‡æ•°ã‚µãƒ¼ãƒãƒ¼é–“ã§ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å…±æœ‰ä¸å¯
</p>

<h3>4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®åˆ¶é™</h3>

<ul>
<li><strong>ã‚­ãƒ£ãƒƒã‚·ãƒ¥</strong>: ãªã—ï¼ˆæœ¬ç•ªç’°å¢ƒã§ã¯Redisä½¿ç”¨äºˆå®šï¼‰</li></ul>

<ul>
<li><strong>ãƒ¬ãƒ¼ãƒˆåˆ¶é™</strong>: ãªã—</li></ul>

<ul>
<li><strong>è² è·åˆ†æ•£</strong>: éå¯¾å¿œ</li></ul>

<ul>
<li><strong>ç›£è¦–ãƒ»ãƒ­ã‚°</strong>: åŸºæœ¬çš„ãªã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã®ã¿</li></ul>


<h2>æœ¬ç•ªç’°å¢ƒã¸ã®ç§»è¡Œã«å¿…è¦ãªæ§‹æˆè¦ç´ </h2>

<h3>1. ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£</h3>

<h4>1.1 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼</h4>
<ul>
<li><strong>æ¨å¥¨æ§‹æˆ</strong>:</li></ul>

<p>
- AWS EC2 / Google Compute Engine / Azure VM
- æœ€å°æ§‹æˆ: 2vCPU, 4GB RAM Ã— 2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
- æ¨å¥¨æ§‹æˆ: 4vCPU, 8GB RAM Ã— 3ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä»¥ä¸Š
- Auto Scalingè¨­å®š
</p>

<h4>1.2 ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼</h4>
<ul>
<li><strong>é¸æŠè‚¢</strong>:</li></ul>

<p>
- AWS Application Load Balancer
- Google Cloud Load Balancer
- Azure Load Balancer
</p>
<ul>
<li><strong>è¨­å®šé …ç›®</strong>:</li></ul>

<p>
- SSLçµ‚ç«¯
- ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ï¼ˆ<code>/api/health</code>ï¼‰
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¢ãƒ•ã‚£ãƒ‹ãƒ†ã‚£
</p>

<h4>1.3 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼</h4>
<ul>
<li><strong>æ¨å¥¨</strong>: PostgreSQL 14ä»¥ä¸Š</li></ul>

<ul>
<li><strong>æœ€å°æ§‹æˆ</strong>:</li></ul>

<p>
- AWS RDS db.t3.medium
- 100GB SSD
- è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æœ‰åŠ¹
</p>
<ul>
<li><strong>æ¨å¥¨æ§‹æˆ</strong>:</li></ul>

<p>
- AWS RDS db.m5.large
- 500GB SSD
- ãƒãƒ«ãƒAZé…ç½®
- ãƒªãƒ¼ãƒ‰ãƒ¬ãƒ—ãƒªã‚« Ã— 1
</p>

<h4>1.4 ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µãƒ¼ãƒãƒ¼</h4>
<ul>
<li><strong>æ¨å¥¨</strong>: Redis 6.2ä»¥ä¸Š</li></ul>

<ul>
<li><strong>æ§‹æˆ</strong>:</li></ul>

<p>
- AWS ElastiCache redis.t3.microï¼ˆæœ€å°ï¼‰
- AWS ElastiCache redis.m5.largeï¼ˆæ¨å¥¨ï¼‰
- ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹
</p>

<h4>1.5 ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</h4>
<ul>
<li><strong>æ¨å¥¨</strong>: AWS S3</li></ul>

<ul>
<li><strong>ãƒã‚±ãƒƒãƒˆæ§‹æˆ</strong>:</li></ul>

<p>
``<code>
fbt-production/
â”œâ”€â”€ product-images/
â”œâ”€â”€ shipping-labels/
â”œâ”€â”€ inspection-videos/
â”œâ”€â”€ documents/
â””â”€â”€ temp/
</code>`<code>
</p>
<ul>
<li><strong>è¨­å®š</strong>:</li></ul>

<p>
- ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æœ‰åŠ¹
- ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼è¨­å®š
- CloudFront CDNé€£æº
</p>

<h3>2. å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº</h3>

<h4>2.1 eBay APIçµ±åˆ</h4>
<ul>
<li><strong>å¿…è¦ãªèªè¨¼æƒ…å ±</strong>:</li></ul>

<p>
</code>`<code>
EBAY<em>CLIENT</em>ID=<Production App ID>
EBAY<em>CLIENT</em>SECRET=<Production Cert ID>
EBAY<em>OAUTH</em>REFRESH_TOKEN=<OAuth Refresh Token>
EBAY_ENVIRONMENT=PRODUCTION
</code>`<code>
</p>
<ul>
<li><strong>APIã‚¹ã‚³ãƒ¼ãƒ—</strong>:</li></ul>

<p>
- sell.inventory
- sell.fulfillment
- sell.analytics
- sell.marketing
</p>

<h4>2.2 FedEx APIçµ±åˆ</h4>
<ul>
<li><strong>å¿…è¦ãªèªè¨¼æƒ…å ±</strong>:</li></ul>

<p>
</code>`<code>
FEDEX<em>ACCOUNT</em>NUMBER=<ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç•ªå·>
FEDEX<em>METER</em>NUMBER=<ãƒ¡ãƒ¼ã‚¿ãƒ¼ç•ªå·>
FEDEX_KEY=<èªè¨¼ã‚­ãƒ¼>
FEDEX_PASSWORD=<ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰>
FEDEX_ENVIRONMENT=production
</code>`<code>
</p>
<ul>
<li><strong>å¿…è¦ãªã‚µãƒ¼ãƒ“ã‚¹</strong>:</li></ul>

<p>
- Ship Service
- Track Service
- Rate Service
</p>

<h4>2.3 SendGridï¼ˆãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼‰</h4>
<ul>
<li><strong>å¿…è¦ãªè¨­å®š</strong>:</li></ul>

<p>
</code>`<code>
SENDGRID<em>API</em>KEY=<APIã‚­ãƒ¼>
SENDGRID<em>FROM</em>EMAIL=noreply@yourcompany.com
SENDGRID<em>FROM</em>NAME=The World Door
</code>`<code>
</p>
<ul>
<li><strong>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­å®š</strong>:</li></ul>

<p>
- ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒ¼ãƒ«
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ
- 2æ®µéšèªè¨¼ã‚³ãƒ¼ãƒ‰
- æ³¨æ–‡ç¢ºèª
- é…é€é€šçŸ¥
</p>

<h4>2.4 AWS S3ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼‰</h4>
<ul>
<li><strong>å¿…è¦ãªè¨­å®š</strong>:</li></ul>

<p>
</code>`<code>
AWS<em>ACCESS</em>KEY_ID=<ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼>
AWS<em>SECRET</em>ACCESS_KEY=<ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼>
AWS_REGION=ap-northeast-1
AWS<em>S3</em>BUCKET=fbt-production
</code>`<code>
</p>
<ul>
<li><strong>IAMãƒãƒªã‚·ãƒ¼</strong>:</li></ul>

<p>
</code>`<code>json
{
"Version": "2012-10-17",
"Statement": [
{
"Effect": "Allow",
"Action": [
"s3:PutObject",
"s3:GetObject",
"s3:DeleteObject",
"s3:ListBucket"
],
"Resource": [
"arn:aws:s3:::fbt-production/*",
"arn:aws:s3:::fbt-production"
]
}
]
}
</code>`<code>
</p>

<h4>2.5 OpenAI APIï¼ˆAIæ©Ÿèƒ½ï¼‰</h4>
<ul>
<li><strong>å¿…è¦ãªè¨­å®š</strong>:</li></ul>

<p>
</code>`<code>
OPENAI<em>API</em>KEY=<APIã‚­ãƒ¼>
OPENAI_MODEL=gpt-4
</code>`<code>
</p>

<h3>3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š</h3>

<h4>3.1 SSL/TLSè¨¼æ˜æ›¸</h4>
<ul>
<li><strong>æ¨å¥¨</strong>: Let's Encryptï¼ˆç„¡æ–™ï¼‰ã¾ãŸã¯AWS Certificate Manager</li></ul>

<ul>
<li><strong>è¨­å®š</strong>:</li></ul>

<p>
- å¼·åˆ¶HTTPS
- HSTSæœ‰åŠ¹åŒ–
- TLS 1.2ä»¥ä¸Š
</p>

<h4>3.2 ç’°å¢ƒå¤‰æ•°ç®¡ç†</h4>
<ul>
<li><strong>æ¨å¥¨ãƒ„ãƒ¼ãƒ«</strong>:</li></ul>

<p>
- AWS Secrets Manager
- HashiCorp Vault
- Azure Key Vault
</p>
<ul>
<li><strong>ç®¡ç†å¯¾è±¡</strong>:</li></ul>

<p>
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±
- APIèªè¨¼æƒ…å ±
- JWTç§˜å¯†éµ
- æš—å·åŒ–ã‚­ãƒ¼
</p>

<h4>3.3 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼</h4>
<p>
</code>`<code>typescript
// next.config.js
const securityHeaders = [
{
key: 'X-DNS-Prefetch-Control',
value: 'on'
},
{
key: 'Strict-Transport-Security',
value: 'max-age=63072000; includeSubDomains; preload'
},
{
key: 'X-Frame-Options',
value: 'SAMEORIGIN'
},
{
key: 'X-Content-Type-Options',
value: 'nosniff'
},
{
key: 'X-XSS-Protection',
value: '1; mode=block'
},
{
key: 'Referrer-Policy',
value: 'origin-when-cross-origin'
},
{
key: 'Content-Security-Policy',
value: "default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline';"
}
]
</code>`<code>
</p>

<h3>4. ç›£è¦–ãƒ»ãƒ­ã‚°ç®¡ç†</h3>

<h4>4.1 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç›£è¦–</h4>
<ul>
<li><strong>Sentryï¼ˆã‚¨ãƒ©ãƒ¼ç›£è¦–ï¼‰</strong>:</li></ul>

<p>
</code>`<code>
SENTRY_DSN=<Sentry DSN>
SENTRY_ENVIRONMENT=production
</code>`<code>
</p>
<ul>
<li><strong>è¨­å®šé …ç›®</strong>:</li></ul>

<p>
- ã‚¨ãƒ©ãƒ¼é€šçŸ¥
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
- ãƒªãƒªãƒ¼ã‚¹è¿½è·¡
</p>

<h4>4.2 ã‚¤ãƒ³ãƒ•ãƒ©ç›£è¦–</h4>
<ul>
<li><strong>Datadog / CloudWatch / Azure Monitor</strong>:</li></ul>

<p>
- CPU/ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡
- ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæ•°
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ 
</p>

<h4>4.3 ãƒ­ã‚°ç®¡ç†</h4>
<ul>
<li><strong>æ¨å¥¨æ§‹æˆ</strong>:</li></ul>

<p>
</code>`<code>
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ â†’ CloudWatch Logs â†’ S3ï¼ˆé•·æœŸä¿å­˜ï¼‰
â†“
Elasticsearchï¼ˆæ¤œç´¢ãƒ»åˆ†æï¼‰
</code>`<code>
</p>
<ul>
<li><strong>ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«</strong>: productionç’°å¢ƒã§ã¯</code>info<code>ä»¥ä¸Š</li></ul>


<h3>5. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ç½å®³å¾©æ—§</h3>

<h4>5.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</h4>
<ul>
<li><strong>è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</strong>:</li></ul>

<p>
- æ—¥æ¬¡ãƒ•ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- 5åˆ†ã”ã¨ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ­ã‚°
- 30æ—¥é–“ä¿æŒ
</p>
<ul>
<li><strong>æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</strong>:</li></ul>

<p>
- ãƒªãƒªãƒ¼ã‚¹å‰å¾Œ
- å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿å¤‰æ›´å‰
</p>

<h4>5.2 ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</h4>
<ul>
<li><strong>S3è¨­å®š</strong>:</li></ul>

<p>
- ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æœ‰åŠ¹
- ã‚¯ãƒ­ã‚¹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- Glacierç§»è¡Œï¼ˆ90æ—¥ä»¥é™ï¼‰
</p>

<h4>5.3 ç½å®³å¾©æ—§è¨ˆç”»</h4>
<ul>
<li><strong>RTOï¼ˆç›®æ¨™å¾©æ—§æ™‚é–“ï¼‰</strong>: 4æ™‚é–“</li></ul>

<ul>
<li><strong>RPOï¼ˆç›®æ¨™å¾©æ—§æ™‚ç‚¹ï¼‰</strong>: 1æ™‚é–“</li></ul>

<ul>
<li><strong>å¾©æ—§æ‰‹é †æ›¸ã®ä½œæˆ</strong></li></ul>


<h2>æ®µéšçš„ç§»è¡Œè¨ˆç”»</h2>

<h3>Phase 1: é–‹ç™ºç’°å¢ƒã®æº–å‚™ï¼ˆ1é€±é–“ï¼‰</h3>
<ul>
<li>æœ¬ç•ªç”¨ç’°å¢ƒå¤‰æ•°ã®æº–å‚™</li></ul>

<ul>
<li>å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ</li></ul>

<ul>
<li>SSLè¨¼æ˜æ›¸ã®å–å¾—</li></ul>

<ul>
<li>ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š</li></ul>


<h3>Phase 2: ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒæ§‹ç¯‰ï¼ˆ2é€±é–“ï¼‰</h3>
<ul>
<li>ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰ï¼ˆæœ€å°æ§‹æˆï¼‰</li></ul>

<ul>
<li>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç§»è¡Œ</li></ul>

<ul>
<li>å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æºãƒ†ã‚¹ãƒˆ</li></ul>

<ul>
<li>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š</li></ul>


<h3>Phase 3: æœ¬ç•ªç’°å¢ƒæ§‹ç¯‰ï¼ˆ1é€±é–“ï¼‰</h3>
<ul>
<li>æœ¬ç•ªã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰</li></ul>

<ul>
<li>è² è·ãƒ†ã‚¹ãƒˆ</li></ul>

<ul>
<li>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»</li></ul>

<ul>
<li>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š</li></ul>


<h3>Phase 4: ãƒ‡ãƒ¼ã‚¿ç§»è¡Œï¼ˆ3æ—¥é–“ï¼‰</h3>
<ul>
<li>ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿æŠ•å…¥</li></ul>

<ul>
<li>åˆæœŸãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ</li></ul>

<ul>
<li>æ¨©é™è¨­å®š</li></ul>

<ul>
<li>å‹•ä½œç¢ºèª</li></ul>


<h3>Phase 5: åˆ‡ã‚Šæ›¿ãˆï¼ˆ1æ—¥ï¼‰</h3>
<ul>
<li>DNSã®åˆ‡ã‚Šæ›¿ãˆ</li></ul>

<ul>
<li>ç›£è¦–é–‹å§‹</li></ul>

<ul>
<li>æœ¬ç•ªç¨¼åƒ</li></ul>


<h2>è©³ç´°ãªå¯¾å‡¦æ–¹æ³•</h2>

<h3>1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç§»è¡Œæ‰‹é †</h3>

<h4>1.1 PostgreSQLç’°å¢ƒæº–å‚™</h4>
<p>
</code>`<code>bash
</p>
<h1>1. PostgreSQLã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ï¼‰</h1>
<p>
sudo apt-get update
sudo apt-get install postgresql postgresql-contrib
</p>

<h1>2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆ</h1>
<p>
sudo -u postgres psql
CREATE DATABASE fbt_production;
CREATE USER fbt<em>user WITH ENCRYPTED PASSWORD 'your</em>secure_password';
GRANT ALL PRIVILEGES ON DATABASE fbt<em>production TO fbt</em>user;
</code>`<code>
</p>

<h4>1.2 Prismaã‚¹ã‚­ãƒ¼ãƒã®æ›´æ–°</h4>
<p>
</code>`<code>prisma
// prisma/schema.prisma
datasource db {
provider = "postgresql"  // SQLiteã‹ã‚‰å¤‰æ›´
url      = env("DATABASE_URL")
}
</p>

<p>
// PostgreSQLç‰¹æœ‰ã®æ©Ÿèƒ½ã‚’æ´»ç”¨
model Product {
id          String   @id @default(uuid()) // UUIDã‚’ä½¿ç”¨
data        Json     // JSONå‹ã‚’æ´»ç”¨
tags        String[] // é…åˆ—å‹ã‚’ä½¿ç”¨
// ...
}
</code>`<code>
</p>

<h4>1.3 ãƒ‡ãƒ¼ã‚¿ç§»è¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h4>
<p>
</code>`<code>typescript
// scripts/migrate-to-postgres.ts
import { PrismaClient as SqliteClient } from '@prisma/client'
import { PrismaClient as PostgresClient } from './generated/postgres-client'
</p>

<p>
async function migrateData() {
const sqlite = new SqliteClient({
datasources: { db: { url: 'file:./dev.db' } }
})
</p>

<p>
const postgres = new PostgresClient({
datasources: { db: { url: process.env.DATABASE_URL } }
})
</p>

<p>
// ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ç§»è¡Œ
await postgres.$transaction(async (tx) => {
// Users
const users = await sqlite.user.findMany()
await tx.user.createMany({ data: users })
</p>

<p>
// Products
const products = await sqlite.product.findMany()
await tx.product.createMany({ data: products })
</p>

<p>
// ... ä»–ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚‚åŒæ§˜ã«
})
}
</code>`<code>
</p>

<h3>2. APIãƒ«ãƒ¼ãƒˆã®æœ¬ç•ªå¯¾å¿œ</h3>

<h4>2.1 ç’°å¢ƒã«ã‚ˆã‚‹åˆ†å²ã®å®Ÿè£…</h4>
<p>
</code>`<code>typescript
// lib/config/index.ts
export function getConfig() {
const env = process.env.NODE_ENV || 'development'
</p>

<p>
if (env === 'production') {
return productionConfig
}
</p>

<p>
return developmentConfig
}
</p>

<p>
// API routeã§ã®ä½¿ç”¨ä¾‹
// app/api/products/route.ts
import { getConfig } from '@/lib/config'
</p>

<p>
export async function GET() {
const config = getConfig()
</p>

<p>
if (config.dataSource === 'prisma') {
try {
const products = await prisma.product.findMany()
return NextResponse.json(products)
} catch (error) {
// æœ¬ç•ªç’°å¢ƒã§ã¯ã‚¨ãƒ©ãƒ¼ã‚’Sentryã«é€ä¿¡
captureException(error)
return NextResponse.json(
{ error: 'Internal Server Error' },
{ status: 500 }
)
}
}
</p>

<p>
// é–‹ç™ºç’°å¢ƒã®ã¿ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿
return NextResponse.json(mockProducts)
}
</code>`<code>
</p>

<h4>2.2 å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®æœ¬ç•ªå¯¾å¿œ</h4>
<p>
</code>`<code>typescript
// lib/services/adapters/ebay.adapter.ts
export class EbayAdapter {
private client: any
</p>

<p>
constructor() {
const config = getConfig()
</p>

<p>
if (config.ebay.useMock) {
this.client = new MockEbayClient()
} else {
this.client = new EbayClient({
clientId: process.env.EBAY<em>CLIENT</em>ID,
clientSecret: process.env.EBAY<em>CLIENT</em>SECRET,
refreshToken: process.env.EBAY<em>OAUTH</em>REFRESH_TOKEN,
environment: process.env.EBAY_ENVIRONMENT
})
}
}
</p>

<p>
async createListing(product: Product) {
try {
const listing = await this.client.inventory.createOrReplaceInventoryItem({
sku: product.sku,
product: {
title: product.title,
description: product.description,
imageUrls: product.images,
aspects: this.mapProductAspects(product)
},
condition: product.condition,
availability: {
shipToLocationAvailability: {
quantity: product.quantity
}
}
})
</p>

<p>
return listing
} catch (error) {
// ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
throw new EbayApiError('Failed to create listing', error)
}
}
}
</code>`<code>
</p>

<h3>3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ã®å®Ÿè£…</h3>

<h4>3.1 JWTèªè¨¼ã®å¼·åŒ–</h4>
<p>
</code>`<code>typescript
// lib/auth.ts
import jwt from 'jsonwebtoken'
import { randomBytes } from 'crypto'
</p>

<p>
// æœ¬ç•ªç’°å¢ƒã§ã¯ç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—
const JWT<em>SECRET = process.env.JWT</em>SECRET || generateSecureKey()
</p>

<p>
function generateSecureKey() {
if (process.env.NODE_ENV === 'production') {
throw new Error('JWT_SECRET must be set in production')
}
return randomBytes(64).toString('hex')
}
</p>

<p>
export async function createToken(userId: string) {
const config = getConfig()
</p>

<p>
return jwt.sign(
{
userId,
iat: Date.now(),
exp: Date.now() + config.security.sessionExpiry
},
JWT_SECRET,
{ algorithm: 'HS512' }
)
}
</code>`<code>
</p>

<h4>3.2 2æ®µéšèªè¨¼ã®å®Ÿè£…</h4>
<p>
</code>`<code>typescript
// lib/services/two-factor-auth.service.ts
import { authenticator } from 'otplib'
import QRCode from 'qrcode'
</p>

<p>
export class TwoFactorAuthService {
async generateSecret(user: User) {
const secret = authenticator.generateSecret()
const otpauth = authenticator.keyuri(
user.email,
'The World Door',
secret
)
</p>

<p>
const qrCode = await QRCode.toDataURL(otpauth)
</p>

<p>
return { secret, qrCode }
}
</p>

<p>
async verifyToken(secret: string, token: string) {
return authenticator.verify({
token,
secret
})
}
}
</code>`<code>
</p>

<h4>3.3 ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®å®Ÿè£…</h4>
<p>
</code>`<code>typescript
// middleware/rate-limit.ts
import { Redis } from 'ioredis'
import { NextRequest, NextResponse } from 'next/server'
</p>

<p>
const redis = new Redis(process.env.REDIS_URL)
</p>

<p>
export async function rateLimit(req: NextRequest) {
const ip = req.ip || req.headers.get('x-forwarded-for')
const key = </code>rate-limit:${ip}<code>
</p>

<p>
const current = await redis.incr(key)
</p>

<p>
if (current === 1) {
await redis.expire(key, 900) // 15åˆ†
}
</p>

<p>
if (current > 100) {
return NextResponse.json(
{ error: 'Too many requests' },
{ status: 429 }
)
}
</p>

<p>
return NextResponse.next()
}
</code>`<code>
</p>

<h3>4. ç›£è¦–ãƒ»ãƒ­ã‚°è¨­å®š</h3>

<h4>4.1 Sentryè¨­å®š</h4>
<p>
</code>`<code>typescript
// app/layout.tsx
import * as Sentry from '@sentry/nextjs'
</p>

<p>
if (process.env.NODE_ENV === 'production') {
Sentry.init({
dsn: process.env.SENTRY_DSN,
environment: process.env.SENTRY_ENVIRONMENT,
tracesSampleRate: 0.1,
beforeSend(event) {
// æ©Ÿå¯†æƒ…å ±ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
if (event.request?.cookies) {
delete event.request.cookies
}
return event
}
})
}
</code>`<code>
</p>

<h4>4.2 æ§‹é€ åŒ–ãƒ­ã‚°ã®å®Ÿè£…</h4>
<p>
</code>`<code>typescript
// lib/logger.ts
import winston from 'winston'
import { CloudWatchTransport } from 'winston-cloudwatch'
</p>

<p>
const logger = winston.createLogger({
format: winston.format.combine(
winston.format.timestamp(),
winston.format.errors({ stack: true }),
winston.format.json()
),
defaultMeta: {
service: 'fbt-api',
environment: process.env.NODE_ENV
},
transports: [
new winston.transports.Console({
level: process.env.LOG_LEVEL || 'info'
})
]
})
</p>

<p>
if (process.env.NODE_ENV === 'production') {
logger.add(new CloudWatchTransport({
logGroupName: '/aws/elasticbeanstalk/fbt-production',
logStreamName: process.env.HOSTNAME || 'default',
awsRegion: process.env.AWS_REGION
}))
}
</p>

<p>
export { logger }
</code>`<code>
</p>

<h3>5. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­å®š</h3>

<h4>5.1 Dockerè¨­å®š</h4>
<p>
</code>`<code>dockerfile
</p>
<h1>Dockerfile</h1>
<p>
FROM node:18-alpine AS deps
WORKDIR /app
COPY package.json package-lock.json ./
RUN npm ci --only=production
</p>

<p>
FROM node:18-alpine AS builder
WORKDIR /app
COPY package.json package-lock.json ./
RUN npm ci
COPY . .
RUN npx prisma generate
RUN npm run build
</p>

<p>
FROM node:18-alpine AS runner
WORKDIR /app
</p>

<p>
ENV NODE_ENV production
</p>

<p>
RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs
</p>

<p>
COPY --from=builder /app/public ./public
COPY --from=builder /app/.next/standalone ./
COPY --from=builder /app/.next/static ./.next/static
COPY --from=builder /app/prisma ./prisma
</p>

<p>
USER nextjs
</p>

<p>
EXPOSE 3000
</p>

<p>
ENV PORT 3000
</p>

<p>
CMD ["node", "server.js"]
</code>`<code>
</p>

<h4>5.2 CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆGitHub Actionsï¼‰</h4>
<p>
</code>`<code>yaml
</p>
<h1>.github/workflows/deploy.yml</h1>
<p>
name: Deploy to Production
</p>

<p>
on:
push:
branches: [main]
</p>

<p>
jobs:
test:
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@v3
- uses: actions/setup-node@v3
with:
node-version: 18
- run: npm ci
- run: npm run test
- run: npm run e2e:headless
</p>

<p>
deploy:
needs: test
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@v3
</p>

<p>
- name: Configure AWS credentials
uses: aws-actions/configure-aws-credentials@v2
with:
aws-access-key-id: ${{ secrets.AWS<em>ACCESS</em>KEY_ID }}
aws-secret-access-key: ${{ secrets.AWS<em>SECRET</em>ACCESS_KEY }}
aws-region: ap-northeast-1
</p>

<p>
- name: Login to Amazon ECR
id: login-ecr
uses: aws-actions/amazon-ecr-login@v1
</p>

<p>
- name: Build and push Docker image
env:
ECR_REGISTRY: ${{ steps.login-ecr.outputs.registry }}
ECR_REPOSITORY: fbt-production
IMAGE_TAG: ${{ github.sha }}
run: |
docker build -t $ECR<em>REGISTRY/$ECR</em>REPOSITORY:$IMAGE_TAG .
docker push $ECR<em>REGISTRY/$ECR</em>REPOSITORY:$IMAGE_TAG
</p>

<p>
- name: Update ECS service
run: |
aws ecs update-service \
--cluster fbt-production \
--service fbt-api \
--force-new-deployment
</code>`<code>
</p>

<h3>6. æœ¬ç•ªç’°å¢ƒã®next.config.js</h3>
<p>
</code>`<code>javascript
// next.config.js
/<em>* @type {import('next').NextConfig} </em>/
const nextConfig = {
output: 'standalone',
</p>

<p>
images: {
domains: [
'fbt-production.s3.amazonaws.com',
'i.ebayimg.com'
],
},
</p>

<p>
async headers() {
return [
{
source: '/:path*',
headers: securityHeaders,
},
]
},
</p>

<p>
async rewrites() {
return [
{
source: '/api/:path*',
destination: process.env.API_URL || 'http://localhost:3000/api/:path*',
},
]
},
</p>

<p>
env: {
NEXT<em>PUBLIC</em>API<em>URL: process.env.API</em>URL,
NEXT<em>PUBLIC</em>ENVIRONMENT: process.env.NODE_ENV,
},
</p>

<p>
experimental: {
instrumentationHook: true,
},
</p>

<p>
webpack: (config, { isServer }) => {
if (isServer) {
config.externals.push('@prisma/client')
}
return config
},
}
</p>

<p>
module.exports = nextConfig
</code>``
</p>

<h2>ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h2>

<h3>äº‹å‰æº–å‚™</h3>
<ul>
<li>[ ] æœ¬ç•ªç”¨ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å–å¾—</li></ul>

<ul>
<li>[ ] SSLè¨¼æ˜æ›¸ã®å–å¾—</li></ul>

<ul>
<li>[ ] AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ</li></ul>

<ul>
<li>[ ] å„ç¨®å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ</li></ul>


<h3>ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰</h3>
<ul>
<li>[ ] VPCã¨ã‚µãƒ–ãƒãƒƒãƒˆã®æ§‹æˆ</li></ul>

<ul>
<li>[ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®è¨­å®š</li></ul>

<ul>
<li>[ ] EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®èµ·å‹•</li></ul>

<ul>
<li>[ ] RDSï¼ˆPostgreSQLï¼‰ã®æ§‹ç¯‰</li></ul>

<ul>
<li>[ ] ElastiCacheï¼ˆRedisï¼‰ã®æ§‹ç¯‰</li></ul>

<ul>
<li>[ ] S3ãƒã‚±ãƒƒãƒˆã®ä½œæˆ</li></ul>

<ul>
<li>[ ] CloudFrontã®è¨­å®š</li></ul>

<ul>
<li>[ ] Route 53ã®DNSè¨­å®š</li></ul>


<h3>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š</h3>
<ul>
<li>[ ] ç’°å¢ƒå¤‰æ•°ã®è¨­å®šï¼ˆSecrets Managerï¼‰</li></ul>

<ul>
<li>[ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</li></ul>

<ul>
<li>[ ] åˆæœŸãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥</li></ul>

<ul>
<li>[ ] ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ</li></ul>


<h3>å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº</h3>
<ul>
<li>[ ] eBay APIèªè¨¼è¨­å®š</li></ul>

<ul>
<li>[ ] FedEx APIèªè¨¼è¨­å®š</li></ul>

<ul>
<li>[ ] SendGridè¨­å®šã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆ</li></ul>

<ul>
<li>[ ] OpenAI APIè¨­å®š</li></ul>


<h3>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h3>
<ul>
<li>[ ] JWTç§˜å¯†éµã®ç”Ÿæˆã¨è¨­å®š</li></ul>

<ul>
<li>[ ] 2æ®µéšèªè¨¼ã®æœ‰åŠ¹åŒ–</li></ul>

<ul>
<li>[ ] ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®è¨­å®š</li></ul>

<ul>
<li>[ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®ç¢ºèª</li></ul>

<ul>
<li>[ ] CORSè¨­å®šã®ç¢ºèª</li></ul>


<h3>ç›£è¦–ãƒ»é‹ç”¨</h3>
<ul>
<li>[ ] Sentryã®è¨­å®š</li></ul>

<ul>
<li>[ ] CloudWatchã‚¢ãƒ©ãƒ¼ãƒ ã®è¨­å®š</li></ul>

<ul>
<li>[ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã®ç¢ºèª</li></ul>

<ul>
<li>[ ] ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š</li></ul>


<h3>ãƒ†ã‚¹ãƒˆ</h3>
<ul>
<li>[ ] ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§ã®ç·åˆãƒ†ã‚¹ãƒˆ</li></ul>

<ul>
<li>[ ] è² è·ãƒ†ã‚¹ãƒˆã®å®Ÿæ–½</li></ul>

<ul>
<li>[ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»</li></ul>

<ul>
<li>[ ] ç½å®³å¾©æ—§ãƒ†ã‚¹ãƒˆ</li></ul>


<h3>æœ¬ç•ªåˆ‡ã‚Šæ›¿ãˆ</h3>
<ul>
<li>[ ] DNSã®åˆ‡ã‚Šæ›¿ãˆ</li></ul>

<ul>
<li>[ ] ç›£è¦–ã®é–‹å§‹</li></ul>

<ul>
<li>[ ] åˆæœŸå‹•ä½œç¢ºèª</li></ul>

<ul>
<li>[ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¢ºèª</li></ul>


<h3>äº‹å¾Œä½œæ¥­</h3>
<ul>
<li>[ ] é–‹ç™ºç’°å¢ƒã®ç„¡åŠ¹åŒ–</li></ul>

<ul>
<li>[ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ›´æ–°</li></ul>

<ul>
<li>[ ] é‹ç”¨æ‰‹é †æ›¸ã®ä½œæˆ</li></ul>

<ul>
<li>[ ] å¼•ãç¶™ã</li></ul>


<h2>ã¾ã¨ã‚</h2>

<p>
æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ã•ã‚ŒãŸæ‰‹é †ã«å¾“ã£ã¦æ®µéšçš„ã«ç§»è¡Œã‚’é€²ã‚ã‚‹ã“ã¨ã§ã€é–‹ç™ºç’°å¢ƒã‹ã‚‰æœ¬ç•ªç’°å¢ƒã¸ã®å®‰å…¨ãªç§»è¡ŒãŒå¯èƒ½ã§ã™ã€‚ç‰¹ã«é‡è¦ãªã®ã¯ï¼š
</p>

<ul>
<li><strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç§»è¡Œ</strong>: SQLiteã‹ã‚‰PostgreSQLã¸ã®ç§»è¡Œã¯æ…é‡ã«è¡Œã†</li></ul>

<ul>
<li><strong>å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº</strong>: å„ã‚µãƒ¼ãƒ“ã‚¹ã®APIèªè¨¼æƒ…å ±ã‚’äº‹å‰ã«æº–å‚™</li></ul>

<ul>
<li><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</strong>: æœ¬ç•ªç’°å¢ƒã§ã¯å¿…ãšå¼·å›ºãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã‚’è¡Œã†</li></ul>

<ul>
<li><strong>ç›£è¦–ä½“åˆ¶</strong>: å•é¡Œã‚’æ—©æœŸç™ºè¦‹ã§ãã‚‹ç›£è¦–ä½“åˆ¶ã‚’æ§‹ç¯‰</li></ul>

<ul>
<li><strong>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</strong>: ãƒ‡ãƒ¼ã‚¿æå¤±ã«å‚™ãˆãŸç¢ºå®Ÿãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½“åˆ¶</li></ul>


<p>
ç§»è¡Œä½œæ¥­ã¯è¨ˆç”»çš„ã«é€²ã‚ã€å„ãƒ•ã‚§ãƒ¼ã‚ºã§ã®ç¢ºèªã‚’æ€ ã‚‰ãªã„ã“ã¨ãŒæˆåŠŸã®éµã¨ãªã‚Šã¾ã™ã€‚
</p>
    </div>
</body>
</html>