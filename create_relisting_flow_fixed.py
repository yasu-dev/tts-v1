import os
from PIL import Image, ImageDraw, ImageFont
import base64
from io import BytesIO

def create_relisting_flow_fixed_image():
    """å†å‡ºå“æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã®ä¿®æ­£ç®‡æ‰€ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ãŸç”»åƒã‚’ä½œæˆ"""
    
    print("ğŸ› ï¸ å†å‡ºå“æ¥­å‹™ãƒ•ãƒ­ãƒ¼ä¿®æ­£ç®‡æ‰€ãƒã‚¤ãƒ©ã‚¤ãƒˆç”»åƒã‚’ä½œæˆä¸­...")
    
    try:
        # ãƒ™ãƒ¼ã‚¹ç”»åƒä½œæˆï¼ˆ1400x900ï¼‰
        img = Image.new('RGB', (1400, 900), (248, 250, 254))
        draw = ImageDraw.Draw(img)
        
        # ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†
        draw.rectangle([0, 0, 1400, 70], fill=(0, 100, 210))
        draw.text((50, 25), "THE WORLD DOOR - ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç†", fill=(255, 255, 255))
        
        # ã‚µã‚¤ãƒ‰ãƒãƒ¼
        draw.rectangle([0, 70, 250, 900], fill=(255, 255, 255))
        draw.text((20, 100), "è¿”å“å‡¦ç†", fill=(26, 26, 26))
        
        # ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢
        draw.rectangle([250, 70, 1400, 900], fill=(248, 250, 254))
        
        # ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
        draw.rectangle([300, 120, 1350, 180], fill=(255, 255, 255))
        draw.text((320, 140), "è¿”å“æ¤œå“    å†å‡ºå“æ¥­å‹™ãƒ•ãƒ­ãƒ¼    è¿”å“ç†ç”±åˆ†æ", fill=(26, 26, 26))
        
        # æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã‚¿ã‚¤ãƒˆãƒ«
        draw.rectangle([300, 200, 1350, 250], fill=(255, 255, 255))
        draw.text((320, 220), "è¿”å“å•†å“å†å‡ºå“æ¥­å‹™ãƒ•ãƒ­ãƒ¼", fill=(26, 26, 26))
        
        # ========== ä¿®æ­£1: ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆã‚¢ã‚¤ã‚³ãƒ³å¤‰æ›´å¯¾å¿œï¼‰ ==========
        # ä¿®æ­£ç®‡æ‰€ã‚’èµ¤æ ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆ
        draw.rectangle([295, 275, 1355, 375], outline=(255, 0, 0), width=3)
        draw.text((300, 258), "ğŸ”´ ä¿®æ­£1: ã‚¢ã‚¤ã‚³ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å‹•çš„å¤‰æ›´", fill=(255, 0, 0))
        
        # ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼èƒŒæ™¯
        draw.rectangle([300, 280, 1350, 370], fill=(255, 255, 255))
        
        # ã‚¹ãƒ†ãƒƒãƒ—å††ï¼ˆä¿®æ­£å¾Œã®çŠ¶æ…‹ã‚’è¡¨ç¤ºï¼‰
        step_positions = [380, 570, 760, 950, 1140]
        step_titles = ['æ¤œå“ç¢ºèª', 'å†™çœŸæ’®å½±', 'å•†å“æ›´æ–°', 'ä¾¡æ ¼è¨­å®š', 'å†å‡ºå“']
        step_statuses = ['completed', 'completed', 'in-progress', 'pending', 'pending']
        
        for i, (x, title, status) in enumerate(zip(step_positions, step_titles, step_statuses)):
            # ã‚¹ãƒ†ãƒƒãƒ—å††ã®è‰²ã‚’çŠ¶æ…‹ã«å¿œã˜ã¦å¤‰æ›´
            if status == 'completed':
                circle_color = (0, 100, 210)  # é’è‰²ï¼ˆå®Œäº†ï¼‰
            elif status == 'in-progress':
                circle_color = (0, 100, 210)  # é’è‰²ï¼ˆé€²è¡Œä¸­ï¼‰
                # é€²è¡Œä¸­ã¯ç‚¹æ»…åŠ¹æœã‚’è¡¨ç¾
                draw.ellipse([x-15, 305, x+15, 335], fill=(100, 150, 255), outline=(0, 100, 210), width=2)
            else:
                circle_color = (200, 200, 200)  # ã‚°ãƒ¬ãƒ¼ï¼ˆå¾…æ©Ÿï¼‰
            
            draw.ellipse([x-12, 308, x+12, 332], fill=circle_color)
            
            # ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆç°¡æ˜“è¡¨ç¤ºï¼‰
            if status != 'pending':
                draw.text((x-3, 315), "âœ“", fill=(255, 255, 255))
            
            # ã‚¹ãƒ†ãƒƒãƒ—ã‚¿ã‚¤ãƒˆãƒ«
            draw.text((x-25, 345), title, fill=(26, 26, 26))
            
            # é€£çµç·š
            if i < len(step_positions) - 1:
                next_x = step_positions[i + 1]
                line_color = (0, 100, 210) if status == 'completed' else (200, 200, 200)
                draw.line([x+12, 320, next_x-12, 320], fill=line_color, width=3)
        
        # ========== ä¿®æ­£2: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ï¼ˆç™½ç”»é¢å•é¡Œä¿®æ­£ï¼‰ ==========
        draw.rectangle([295, 395, 1355, 595], outline=(255, 0, 0), width=3)
        draw.text((300, 378), "ğŸ”´ ä¿®æ­£2: ã‚¹ãƒ†ãƒƒãƒ—ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å‹•çš„è¡¨ç¤ºï¼ˆç™½ç”»é¢ä¿®æ­£ï¼‰", fill=(255, 0, 0))
        
        # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚«ãƒ¼ãƒ‰
        draw.rectangle([300, 400, 1350, 590], fill=(255, 255, 255))
        draw.text((320, 420), "å•†å“æƒ…å ±æ›´æ–°ï¼ˆã‚¹ãƒ†ãƒƒãƒ—3ï¼‰", fill=(26, 26, 26))
        draw.text((320, 450), "å•†å“èª¬æ˜:", fill=(102, 102, 102))
        draw.rectangle([320, 470, 1330, 520], fill=(248, 250, 254), outline=(200, 200, 200))
        draw.text((330, 480), "è¿”å“ç†ç”±ã‚„ç¾åœ¨ã®çŠ¶æ…‹ã‚’è¸ã¾ãˆãŸèª¬æ˜ã‚’å…¥åŠ›...", fill=(102, 102, 102))
        
        # è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        draw.rectangle([320, 540, 1330, 570], fill=(255, 243, 205), outline=(245, 158, 11))
        draw.text((330, 550), "âš ï¸ è¿”å“ç†ç”±ã‚’è€ƒæ…®ã—ã€ã‚ˆã‚Šè©³ç´°ãªå•†å“èª¬æ˜ã‚’è¨˜è¼‰ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨", fill=(146, 64, 14))
        
        # ========== ä¿®æ­£3: ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ï¼ˆçŠ¶æ…‹ç®¡ç†ï¼‰ ==========
        draw.rectangle([295, 615, 1355, 685], outline=(255, 0, 0), width=3)
        draw.text((300, 598), "ğŸ”´ ä¿®æ­£3: ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³çŠ¶æ…‹ç®¡ç†", fill=(255, 0, 0))
        
        # ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢
        draw.rectangle([300, 620, 1350, 680], fill=(255, 255, 255))
        
        # æˆ»ã‚‹ãƒœã‚¿ãƒ³ï¼ˆæœ‰åŠ¹çŠ¶æ…‹ï¼‰
        draw.rectangle([320, 640, 390, 670], fill=(255, 255, 255), outline=(200, 200, 200))
        draw.text((340, 650), "æˆ»ã‚‹", fill=(26, 26, 26))
        
        # æ¬¡ã¸ãƒœã‚¿ãƒ³ï¼ˆæœ‰åŠ¹çŠ¶æ…‹ï¼‰
        draw.rectangle([1260, 640, 1330, 670], fill=(0, 100, 210))
        draw.text((1280, 650), "æ¬¡ã¸", fill=(255, 255, 255))
        
        # ä¿®æ­£å†…å®¹èª¬æ˜ãƒ†ã‚­ã‚¹ãƒˆ
        draw.rectangle([300, 700, 1350, 850], fill=(240, 255, 240), outline=(34, 197, 94))
        draw.text((320, 720), "âœ… ä¿®æ­£å®Œäº†é …ç›®:", fill=(21, 128, 61))
        draw.text((320, 750), "â€¢ ã‚¹ãƒ†ãƒƒãƒ—é·ç§»æ™‚ã®ç™½ç”»é¢å•é¡Œè§£æ±º", fill=(21, 128, 61))
        draw.text((320, 770), "â€¢ ã‚¢ã‚¤ã‚³ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å‹•çš„å¤‰æ›´ï¼ˆå®Œäº†/é€²è¡Œä¸­/å¾…æ©Ÿï¼‰", fill=(21, 128, 61))
        draw.text((320, 790), "â€¢ é€²è¡Œä¸­ã‚¹ãƒ†ãƒƒãƒ—ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœï¼ˆpulseï¼‰", fill=(21, 128, 61))
        draw.text((320, 810), "â€¢ æˆ»ã‚‹/æ¬¡ã¸ãƒœã‚¿ãƒ³ã®é©åˆ‡ãªçŠ¶æ…‹ç®¡ç†", fill=(21, 128, 61))
        draw.text((320, 830), "â€¢ çµ±ä¸€ã‚¢ã‚¤ã‚³ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã®é©ç”¨", fill=(21, 128, 61))
        
        # ç”»åƒä¿å­˜
        img.save('highlighted_relisting_flow.png')
        print("âœ… å†å‡ºå“æ¥­å‹™ãƒ•ãƒ­ãƒ¼ä¿®æ­£ãƒã‚¤ãƒ©ã‚¤ãƒˆç”»åƒä¿å­˜å®Œäº†: highlighted_relisting_flow.png")
        
        # ç”»åƒã‚’é–‹ã
        os.system('start highlighted_relisting_flow.png')
        
    except Exception as e:
        print(f"âŒ ç”»åƒä½œæˆã‚¨ãƒ©ãƒ¼: {e}")
    
    print("\nğŸ¯ å†å‡ºå“æ¥­å‹™ãƒ•ãƒ­ãƒ¼ä¿®æ­£ç®‡æ‰€ãƒã‚¤ãƒ©ã‚¤ãƒˆå®Œäº†!")
    print("èµ¤æ ã®éƒ¨åˆ†ãŒä¿®æ­£ã•ã‚ŒãŸæ©Ÿèƒ½ã§ã™")

if __name__ == "__main__":
    create_relisting_flow_fixed_image() 